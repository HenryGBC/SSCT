<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test</title>
  <link rel="stylesheet" href="main.css" charset="utf-8">
</head>
<body>
  <h1 style="text-align:center">PLC Twido</h1>
  <div class="tablero">
    <div class="title-in">
      <h4>In</h4>
    </div>
    <div class="entradas-btns">
          <div class="btn" id="in-btn-0" data-type="in" data-btn="0"></div>
          <div class="btn" id="in-btn-1" data-type="in" data-btn="1"></div>
          <div class="btn" id="in-btn-2" data-type="in" data-btn="2"></div>
          <div class="btn" id="in-btn-3" data-type="in" data-btn="3"></div>
          <div class="btn" id="in-btn-4" data-type="in" data-btn="4"></div>
          <div class="btn" id="in-btn-5" data-type="in" data-btn="5"></div>
          <div class="btn" id="in-btn-6" data-type="in" data-btn="6"></div>
          <div class="btn" id="in-btn-7" data-type="in" data-btn="7"></div>
          <div class="btn" id="in-btn-8" data-type="in" data-btn="8"></div>
          <div class="btn" id="in-btn-9" data-type="in" data-btn="9"></div>
          <div class="btn" id="in-btn-10" data-type="in" data-btn="10"></div>
          <div class="btn" id="in-btn-11" data-type="in" data-btn="11"></div>
          <div class="btn" id="in-btn-12" data-type="in" data-btn="12"></div>
          <div class="btn" id="in-btn-13" data-type="in" data-btn="13"></div>
          <div class="btn" id="in-btn-14" data-type="in" data-btn="14"></div>
          <div class="btn" id="in-btn-15" data-type="in" data-btn="15"></div>
          <div class="btn" id="in-btn-16" data-type="in" data-btn="16"></div>
          <div class="btn" id="in-btn-17" data-type="in" data-btn="17"></div>
          <div class="btn" id="in-btn-18" data-type="in" data-btn="18"></div>
          <div class="btn" id="in-btn-19" data-type="in" data-btn="19"></div>
          <div class="btn" id="in-btn-20" data-type="in" data-btn="20"></div>
          <div class="btn" id="in-btn-21" data-type="in" data-btn="21"></div>
          <div class="btn" id="in-btn-22" data-type="in" data-btn="22"></div>
          <div class="btn" id="in-btn-23" data-type="in" data-btn="23"></div>
    </div>
    <div class="entradas">
          <div class="led" id="in-0" data-in="false"></div>
          <div class="led" id="in-1" data-in="false"></div>
          <div class="led" id="in-2" data-in="false"></div>
          <div class="led" id="in-3" data-in="false"></div>
          <div class="led" id="in-4" data-in="false"></div>
          <div class="led" id="in-5" data-in="false"></div>
          <div class="led" id="in-6" data-in="false"></div>
          <div class="led" id="in-7" data-in="false"></div>
          <div class="led" id="in-8" data-in="false"></div>
          <div class="led" id="in-9" data-in="false"></div>
          <div class="led" id="in-10" data-in="false"></div>
          <div class="led" id="in-11" data-in="false"></div>
          <div class="led" id="in-12" data-in="false"></div>
          <div class="led" id="in-13" data-in="false"></div>
          <div class="led" id="in-14" data-in="false"></div>
          <div class="led" id="in-15" data-in="false"></div>
          <div class="led" id="in-16" data-in="false"></div>
          <div class="led" id="in-17" data-in="false"></div>
          <div class="led" id="in-18" data-in="false"></div>
          <div class="led" id="in-19" data-in="false"></div>
          <div class="led" id="in-20" data-in="false"></div>
          <div class="led" id="in-21" data-in="false"></div>
          <div class="led" id="in-22" data-in="false"></div>
          <div class="led" id="in-23" data-in="false"></div>
    </div>
    <div class="salidas">
      <div class="led" id="out-24" data-out="false"></div>
      <div class="led" id="out-25" data-out="false"></div>
      <div class="led" id="out-26" data-out="false"></div>
      <div class="led" id="out-27" data-out="false"></div>
      <div class="led" id="out-28" data-out="false"></div>
      <div class="led" id="out-29" data-out="false"></div>
      <div class="led" id="out-30" data-out="false"></div>
      <div class="led" id="out-31" data-out="false"></div>
      <div class="led" id="out-32" data-out="false"></div>
      <div class="led" id="out-33" data-out="false"></div>
      <div class="led" id="out-34" data-out="false"></div>
      <div class="led" id="out-35" data-out="false"></div>
      <div class="led" id="out-36" data-out="false"></div>
      <div class="led" id="out-37" data-out="false"></div>
      <div class="led" id="out-38" data-out="false"></div>
      <div class="led" id="out-39" data-out="false"></div>
    </div>
    <div class="salidas-btns">
          <div class="btn" id="out-btn-24" data-type="out" data-btn="24"></div>
          <div class="btn" id="out-btn-25" data-type="out" data-btn="25"></div>
          <div class="btn" id="out-btn-26" data-type="out" data-btn="26"></div>
          <div class="btn" id="out-btn-27" data-type="out" data-btn="27"></div>
          <div class="btn" id="out-btn-28" data-type="out" data-btn="28"></div>
          <div class="btn" id="out-btn-29" data-type="out" data-btn="29"></div>
          <div class="btn" id="out-btn-30" data-type="out" data-btn="30"></div>
          <div class="btn" id="out-btn-31" data-type="out" data-btn="31"></div>
          <div class="btn" id="out-btn-32" data-type="out" data-btn="32"></div>
          <div class="btn" id="out-btn-33" data-type="out" data-btn="33"></div>
          <div class="btn" id="out-btn-34" data-type="out" data-btn="34"></div>
          <div class="btn" id="out-btn-35" data-type="out" data-btn="35"></div>
          <div class="btn" id="out-btn-36" data-type="out" data-btn="36"></div>
          <div class="btn" id="out-btn-37" data-type="out" data-btn="37"></div>
          <div class="btn" id="out-btn-38" data-type="out" data-btn="38"></div>
          <div class="btn" id="out-btn-39" data-type="out" data-btn="39"></div>
    </div>
    <div class="title-out">
      <h4>Out</h4>
    </div>
  </div>

  <script src="jquery-1.11.3.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
        function changeValue(item, type){
          console.log(item);
          if(item.value==="true"){
            $('#'+type+'-'+item.led).addClass('on');
            $('#'+type+'-btn-'+item.led).addClass('on-btn');
          }else{
            $('#'+type+'-'+item.led).removeClass('on');
            $('#'+type+'-btn-'+item.led).removeClass('on-btn');
          }
          $('#'+type+'-'+item.led).data(type, item.value);
        }
        function initIn(data){
          data.forEach(function(item){
            if(item.value==="true"){
              $('#in-'+item.led).addClass('on');
              $('#in-btn-'+item.led).addClass('on-btn');
            }else{
              $('#in-'+item.led).removeClass('on');
              $('#in-btn-'+item.led).removeClass('on-btn');
            }
            $('#in-'+item.led).data('in', item.value);
          });
        }

        function initOut(data){
          data.forEach(function(item){
            if(item.value==="true"){
              $('#out-'+item.led).addClass('on');
              $('#out-btn-'+item.led).addClass('on-btn');
            }else{
              $('#out-'+item.led).removeClass('on');
              $('#out-btn-'+item.led).removeClass('on-btn');
            }
            $('#out-'+item.led).data('out', item.value);
          });
        }


        function readValues(){
          $.ajax({
              type: "POST",
              url: "read.php",
              //data: dataString,
              success: function(data) {
                var dataRead = JSON.parse(data);
                initIn(dataRead);
              }
          });
        }

        function readOutValues(){
          $.ajax({
              type: "POST",
              url: "readOut.php",
              success: function(data) {
                var dataRead = JSON.parse(data);
                initOut(dataRead);
              }
          });
        }


        $('.btn').on('click', function(event){
            var type = $(this).data('type');
            var led = $(this).data('btn');
            if(type==='out'){
              var value= $('#'+type+'-'+led).data(type);
              var dataObj = {
                led: led,
                value: value
              };
              console.log(dataObj);

              $.ajax({
                  type: "POST",
                  url: "write.php",
                  data: dataObj,
                  success: function(data) {
                      var dataRead = JSON.parse(data);
                      changeValue(dataRead, type);
                  },
                  catch: function(err){
                    console.log(err);
                  }
              });
            }

        });


        function readTest(){
            $.ajax({
                type: "POST",
                url: "write.php",
                data: dataObj,
                success: function(data) {
                    var dataRead = JSON.parse(data);
                    changeValue(dataRead, type);
                },
                catch: function(err){
                  console.log(err);
                }
            });
        }
        readValues();
        readOutValues();
        setInterval(readValues, 1000);
    });
</script>
</body>
</html>
